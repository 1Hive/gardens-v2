query getFactories {
  registryFactories(first: 1000) {
    id
    registryCommunities(first: 1000) {
      id
      chainId
      isValid
      communityName
      covenantIpfsHash
      covenant {
        text
      }
      registerToken
      alloAddress
      members(first: 1000) {
        memberAddress
      }
      strategies(first: 1000) {
        id
        poolId
        isEnabled
        config {
          id
          decay
          maxRatio
          weight
          minThresholdPoints
        }
      }
      membersCount
    }
  }
}

query getTokenGardens {
  tokenGardens(first: 1000) {
    id
    chainId
    name
    symbol
    decimals
    totalBalance
    communities(first: 1000) {
      id
      chainId
      covenantIpfsHash
      covenant {
        text
      }
      communityFee
      isValid
      communityName
      strategies(first: 1000) {
        id
      }
      members(first: 1000) {
        id
        memberAddress
      }
    }
  }
}

query getMembersStrategy($strategyId: String!) {
  memberStrategies(first: 1000, where: { strategy: $strategyId }) {
    activatedPoints
    member {
      memberCommunity {
        memberAddress
        isRegistered
      }
      stakes(
        first: 1000
        where: {
          proposal_: { strategy: $strategyId, proposalStatus_in: [1, 5] }
        }
      ) {
        amount
        proposal {
          proposalStatus
        }
      }
    }
    totalStakedPoints
    id
  }
}

query getMemberStrategy($member_strategy: ID!) {
  memberStrategy(id: $member_strategy) {
    id
    totalStakedPoints
    activatedPoints
    strategy {
      id
    }
    member {
      id
    }
  }
}

query isMember($me: ID!, $comm: String!) {
  member(id: $me) {
    id
    stakes(first: 1000) {
      id
      amount
      proposal {
        id
        proposalNumber
        stakedAmount
        proposalStatus
        strategy {
          id
          poolId
          registryCommunity {
            id
            isValid
            garden {
              id
              symbol
              decimals
            }
          }
        }
      }
    }
    memberCommunity(first: 1000, where: { registryCommunity_contains: $comm }) {
      stakedTokens
      isRegistered
      registryCommunity {
        id
      }
    }
  }
}

query getMember($me: ID!) {
  member(id: $me) {
    id
    memberCommunity(first: 1000) {
      id
      stakedTokens
      isRegistered
      registryCommunity {
        id
        isValid
      }
    }
    stakes(first: 1000) {
      id
      proposal {
        proposalNumber
        id
      }
      amount
      createdAt
    }
  }
}

query getPoolCreationData($communityAddr: ID!, $tokenAddr: ID!) {
  tokenGarden(id: $tokenAddr) {
    decimals
    id
    symbol
  }
  allos(first: 1000) {
    id
  }
  registryCommunity(id: $communityAddr) {
    communityName
    isValid
  }
}

query getProposalSupporters($proposalId: String!) {
  members(first: 1000) {
    id
    stakes(where: { proposal: $proposalId }, first: 1000) {
      amount
      proposal {
        proposalNumber
        id
      }
    }
  }
}

query getGardenCommunities($chainId: BigInt!, $tokenGarden: ID!) {
  registryCommunities(
    first: 1000
    where: { chainId: $chainId, garden_: { id: $tokenGarden } }
  ) {
    id
    garden {
      id
    }
    chainId
    isValid
    covenantIpfsHash
    covenant {
      text
    }
    communityName
    protocolFee
    communityFee
    registerToken
    registerStakeAmount
    alloAddress
    members(first: 1000, where: { stakedTokens_gt: "0" }) {
      id
      memberAddress
    }
    strategies(first: 1000, where: { isEnabled: true }) {
      id
      totalEffectiveActivePoints
      poolId
    }
    membersCount
  }
}

query getCommunities {
  registryCommunities(first: 1000, where: { isValid: true }) {
    id
    councilSafe
    communityName
    archived
    garden {
      address
      chainId
      symbol
      name
      decimals
    }
    strategies(first: 1000, where: { isEnabled: true }) {
      id
      totalEffectiveActivePoints
      poolId
      proposals(first: 1000, where: { proposalStatus: 1 }) {
        id
        proposalStatus
      }
    }
    members(first: 1000, where: { stakedTokens_gt: "0" }) {
      id
      memberAddress
      stakedTokens
    }
    membersCount
  }
}

query getCommunity($communityAddr: ID!, $tokenAddr: ID!) {
  registryCommunity(id: $communityAddr) {
    communityName
    id
    archived
    members(
      first: 1000
      where: { stakedTokens_gt: "0" }
      orderBy: stakedTokens
      orderDirection: desc
    ) {
      memberAddress
      stakedTokens
    }
    strategies(first: 1000, orderBy: poolId, orderDirection: desc) {
      id
      proposals(first: 1000) {
        id
      }
      archived
      isEnabled
      poolId
      token
      metadataHash
      metadata {
        title
        description
      }
      config {
        proposalType
        pointSystem
      }
      proposals(first: 1000) {
        id
      }
    }
    covenantIpfsHash
    covenant {
      text
    }
    communityFee
    protocolFee
    registerStakeAmount
    registerToken
    councilSafe
    membersCount
  }
  tokenGarden(id: $tokenAddr) {
    symbol
    decimals
    id
  }
}

query getCommunityCreationData {
  registryFactories(first: 1000) {
    id
  }
}

query getRegistryFactoryData {
  registryFactories(first: 1000) {
    id
    chainId
  }
}

query getPoolData($garden: ID!, $poolId: BigInt!) {
  allos(first: 1000) {
    id
    chainId
    tokenNative
  }
  tokenGarden(id: $garden) {
    address
    name
    symbol
    description
    totalBalance
    ipfsCovenant
    decimals
  }
  cvstrategies(first: 1000, where: { poolId: $poolId }) {
    token
    metadataHash
    metadata {
      title
      description
    }
    id
    poolId
    totalEffectiveActivePoints
    isEnabled
    maxCVSupply
    archived
    sybil {
      id
      type
    }
    memberActive(first: 1000) {
      id
    }
    config {
      id
      weight
      decay
      maxAmount
      maxRatio
      minThresholdPoints
      pointSystem
      proposalType
      allowlist
      superfluidToken
    }
    stream {
      id
      contractAddress
      contractType
      superfluidToken
      maxFlowRate
      superfluidGDA
      streamLastFlowRate
      createdAt
      updatedAt
    }
    registryCommunity {
      id
      councilSafe
      isValid
      garden {
        id
        symbol
        decimals
      }
      members(first: 1000) {
        memberAddress
      }
    }
    proposals(first: 1000, orderBy: convictionLast, orderDirection: desc) {
      id
      proposalNumber
      metadataHash
      metadata {
        title
        description
      }
      beneficiary
      requestedAmount
      requestedToken
      proposalStatus
      stakedAmount
      convictionLast
      createdAt
      executedAt
      blockLast
      submitter
      strategy {
        id
        maxCVSupply
        totalEffectiveActivePoints
      }
    }
  }
  arbitrableConfigs(
    first: 1
    orderBy: version
    orderDirection: desc
    where: { strategy_: { poolId: $poolId } }
  ) {
    submitterCollateralAmount
    challengerCollateralAmount
    arbitrator
    defaultRuling
    defaultRulingTimeout
    tribunalSafe
  }
}

query getProposalData($garden: ID!, $proposalId: ID!, $communityId: ID!) {
  allos(first: 1000) {
    id
    chainId
    tokenNative
  }
  tokenGarden(id: $garden) {
    name
    symbol
    decimals
  }
  registryCommunity(id: $communityId) {
    councilSafe
  }
  cvproposal(id: $proposalId) {
    id
    proposalNumber
    beneficiary
    blockLast
    convictionLast
    createdAt
    metadataHash
    metadata {
      title
      description
    }
    proposalStatus
    requestedAmount
    requestedToken
    stakedAmount
    submitter
    updatedAt
    executedAt
    version
    strategy {
      id
      token
      maxCVSupply
      totalEffectiveActivePoints
      poolId
      isEnabled
      registryCommunity {
        id
        councilSafe
        isValid
        garden {
          id
          symbol
          decimals
        }
        members(first: 1000) {
          memberAddress
        }
      }
      config {
        proposalType
        pointSystem
        minThresholdPoints
        decay
        weight
        maxRatio
        maxAmount
        allowlist
        superfluidToken
      }
    }
    arbitrableConfig {
      arbitrator
      defaultRuling
      defaultRulingTimeout
      challengerCollateralAmount
      submitterCollateralAmount
      tribunalSafe
    }
  }
}

query getAllo {
  allos(first: 1000) {
    id
    chainId
    tokenNative
  }
}

query getStrategyByPool($poolId: BigInt!) {
  cvstrategies(first: 1000, where: { poolId: $poolId }) {
    id
    poolId
    totalEffectiveActivePoints
    isEnabled
    archived
    config {
      id
      proposalType
      pointSystem
      minThresholdPoints
    }
    memberActive(first: 1000) {
      id
    }
    registryCommunity {
      id
      isValid
      garden {
        id
        symbol
        decimals
      }
    }
    proposals(first: 1000) {
      id
      proposalNumber
      metadataHash
      metadata {
        title
        description
      }
      beneficiary
      requestedAmount
      requestedToken
      proposalStatus
      stakedAmount
    }
  }
}

query getTokenTitle($tokenAddr: ID!) {
  tokenGarden(id: $tokenAddr) {
    name
  }
}

query getCommunityTitles($communityAddr: ID!) {
  registryCommunity(id: $communityAddr) {
    communityName
    garden {
      name
    }
  }
}

query getPoolTitles($poolId: BigInt!) {
  cvstrategies(first: 1000, where: { poolId: $poolId }) {
    poolId
    metadataHash
    metadata {
      title
      description
    }
    registryCommunity {
      communityName
      garden {
        name
      }
    }
  }
}

query getProposalTitles($proposalId: ID!) {
  cvproposal(id: $proposalId) {
    proposalNumber
    metadataHash
    metadata {
      title
      description
    }
    strategy {
      poolId
      metadataHash
      metadata {
        title
        description
      }
      registryCommunity {
        communityName
        garden {
          name
        }
      }
    }
  }
}

query getPassportStrategy($strategyId: ID!) {
  passportStrategy(id: $strategyId) {
    id
    passportScorer {
      id
      type
    }
    threshold
    councilSafe
    active
  }
}

query getPassportUser($userId: ID!) {
  passportUser(id: $userId) {
    id
    userAddress
    score
    lastUpdated
  }
}

query getGoodDollarStrategy($strategyId: ID!) {
  goodDollarStrategy(id: $strategyId) {
    id
    sybilProtection {
      id
      type
    }
    councilSafe
    active
  }
}

query getGoodDollarUser($userId: ID!) {
  goodDollarUser(id: $userId) {
    id
    userAddress
    verified
    lastUpdated
  }
}

query getProposalDisputes($proposalId: ID!) {
  proposalDisputes(first: 1000, where: { proposal_: { id: $proposalId } }) {
    id
    disputeId
    status
    challenger
    context
    metadata {
      id
      reason
    }
    createdAt
    ruledAt
    rulingOutcome
  }
}

query getArbitrableConfigs($strategyId: String!) {
  arbitrableConfigs(first: 1000, where: { strategy: $strategyId }) {
    arbitrator
    challengerCollateralAmount
    submitterCollateralAmount
    tribunalSafe
    defaultRuling
    defaultRulingTimeout
  }
}

query getMemberPassportAndCommunities($memberId: ID!) {
  member(id: $memberId) {
    memberCommunity(first: 1000) {
      id
    }
  }
  passportUser(id: $memberId) {
    lastUpdated
    score
  }
}

# query getStrategyArbitrationConfig($strategyConfigId: ID!) {
#   cvstrategyConfig(id: $strategyConfigId) {
#     challengerCollateralAmount
#     submitterCollateralAmount
#     arbitrator
#     tribunalSafe
#     defaultRuling
#     defaultRulingTimeout
#   }
# }

query getCommunityName($communityAddr: ID!) {
  registryCommunity(id: $communityAddr) {
    communityName
  }
}

query getPoolTitle($poolId: BigInt!) {
  cvstrategies(first: 1, where: { poolId: $poolId }) {
    metadata {
      title
    }
    archived
    isEnabled
    config {
      proposalType
    }
    registryCommunity {
      communityName
    }
  }
}

query getProposalTitle($proposalId: ID!) {
  cvproposal(id: $proposalId) {
    metadata {
      title
    }
    proposalStatus
    strategy {
      metadata {
        title
      }
      registryCommunity {
        communityName
      }
      config {
        proposalType
      }
    }
  }
}

query getFactories {
  registryFactories {
    id
    registryCommunities {
      id
      chainId
      communityName
      covenantIpfsHash
      registerToken
      alloAddress
      members {
        memberAddress
      }
      strategies {
        id
        poolId
        config {
          id
          decay
          maxRatio
          weight
        }
      }
    }
  }
}

query getTokenGardens {
  tokenGardens {
    id
    chainId
    name
    symbol
    decimals
    totalBalance
    communities {
      id
      chainId
      members {
        id
      }
    }
  }
}
query getPool($poolId: BigInt!) {
  cvstrategies(where: { poolId: $poolId }) {
    id
    poolId
    proposals {
      id
      requestedAmount
      requestedToken
      stakedTokens
      # proposalType
      proposalStatus
      submitter
      metadata
      beneficiary
    }
  }
}

query isMember($me: ID!, $comm: String!) {
  members(where: { id: $me }) {
    id
    memberCommunity(where: { registryCommunity_contains: $comm }) {
      id
      registryCommunity {
        id
      }
    }
  }
}

# query getCommunity($addr: ID!) {
#   registryCommunity(id: $addr) {
#     id
#     strategies {
#       id
#       poolId
#       proposals {
#         id
#       }
#     }
#   }
# }

query getCommunityByGarden($addr: ID!) {
  tokenGarden(id: $addr) {
    id
    name
    symbol
    chainId
    communities {
      id
      chainId
      communityName
      registerToken
      registerStakeAmount
      members {
        id
        memberAddress
      }
      strategies {
        registryCommunity {
          registerStakeAmount
        }
        id
        poolId
        poolAmount
        config {
          id
          proposalType
        }
        proposals {
          id
        }
      }
    }
  }
}

query getProposalData($garden: ID!, $poolId: BigInt!, $proposalId: ID!) {
  tokenGarden(id: $garden) {
    name
    symbol
    communities {
      strategies(where: { poolId: $poolId }) {
        proposals(where: { id: $proposalId }) {
          beneficiary
          blockLast
          convictionLast
          createdAt
          metadata
          proposalStatus
          requestedAmount
          requestedToken
          stakedTokens
          submitter
          threshold
          updatedAt
          version
          strategy {
            id
            config {
              proposalType
            }
          }
        }
      }
    }
  }
}

query getAllo {
  allos {
    id
    chainId
    tokenNative
  }
}

query getStrategyByPool($poolId: BigInt!) {
  cvstrategies(where: { poolId: $poolId }) {
    id
    poolId
    config {
      id
      proposalType
    }
    registryCommunity {
      id
    }
    proposals {
      id
      metadata
      beneficiary
      requestedAmount
      requestedToken
      proposalStatus
      stakedTokens
    }
  }
}
